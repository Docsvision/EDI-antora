= Структура модуля

== Сведения о структуре модуля

Модуль состоит из следующих компонентов:

* Библиотека карточек "Обмен юридически значимыми документами" с карточками:
** "Справочник настроек операторов ЮЗДО" – карточка Docsvision, в которой:
*** настраивается параметры подключение к сервисам операторов ЭДО;
*** указываются программные компоненты с реализацией функций обмена информацией с операторами ЭДО через коннекторы к операторам ЭДО;
*** указываются данные организаций-участников ЭДО;
** "Карточка обмена сообщениями" – карточка Docsvision с данными документа, отправляемого оператору ЭДО, на основе которых формируются электронные сообщения для оператора;
** "Расширение навигатора ЮЗДО" – добавляет на ленту Windows-клиента раздел "ЮЗДО" с кнопками отправки и подписания неформализованных документов.
* Программные компоненты (библиотеки DLL):
** компонент чтения – содержит функцию получения данных из карточек определенного типа/вида; используется при создании [.dfn .term]_Карточек обмена сообщениями_;
** компонент изменения – содержит функцию изменения данных в карточках определенного типа/вида; используется при изменении документов, по которым поступили ответы от оператора ЭДО;
** компонент создания – содержит функцию создания карточек определенного типа/вида; используется при создании карточек в системе Docsvision по документам, поступившим от оператора ЭДО;
** сервис сообщений – содержит функции отправки и получения электронных сообщений оператору ЭДО;
** компонент импорта – содержит функции получения конфигурации от оператора ЭДО: списка подразделений организации и связанных организаций; списка контрагентов и ящиков;
** компонент работы с подписями – содержит функции подписания электронных сообщений и текстовых комментариев, отправляемых оператору ЭДО.

== Сведения о связях между составными частями модуля

При выполнении в карточке Документа действий, предусматривающих необходимость передачи документа оператору ЭДО, формируется [.dfn .term]_Карточка обмена сообщениями_. Данные, необходимые для создания [.dfn .term]_Карточки обмена сообщениями_, предоставляются компонентом чтения, который получает их из отправляемого документа. Для чтения каждого вида карточек может использовать собственный компонент чтения.

При появлении в системе новой [.dfn .term]_Карточки обмена сообщениями_ БП "Отправка сообщений ЮЗДО" формирует исходящее сообщение электронного обмена для оператора ЭДО и передаёт его по каналу связи. При отправке сообщения используется реализация сервиса сообщений коннектора к данному оператору ЭДО (устанавливается отдельно).

БП "Получение сообщений ЮЗДО" получает входящие сообщения от операторов ЭДО. Способ обработки входящих сообщений зависит от их содержимого:

* при получении электронного документа – в Docsvision создаётся карточка документа;
* при получении квитанции, подтверждающей получение оператором ЭДО отправленного формализованного документа – изменяется статус исходной карточки документа, а пользователю предоставляется возможность отправить оператору ЭДО подтверждение о получении извещения;
* при получении ответа на отправленный неформализованный документ – изменяется статус обмена.

БП "Перенос файлов из сообщений ЮЗДО" переносит полученные от контрагентов титулы покупателя в карточки УПД.

== Сведения о связях с другими системами

_{em}_ является промежуточным звеном в связи системы Docsvision с операторами ЭДО.

Модуль предоставляет публичные интерфейсы, которые используются системой Docsvision для вызова функций коннекторов к операторам ЭДО. Коннекторы непосредственно подключаются к операторам ЭДО через каналы связи для передачи и получения электронных сообщений.

image::linksWithOtherSystems.png[Связь модуля с другими системами]

